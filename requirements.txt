# ==============================================================================
# PRODUCTION DEPENDENCIES
# ==============================================================================
#
# Зависимости, необходимые для работы бота в продакшене (на Amvera).
# Устанавливаются командой: pip install -r requirements.txt

# ------------------------------------------------------------------------------
# Telegram Bot
# ------------------------------------------------------------------------------

# aiogram — современный асинхронный фреймворк для Telegram Bot API.
# Используется для обработки сообщений, команд, колбэков, медиа и т.д.
aiogram>=3.24.0,<4.0

# ------------------------------------------------------------------------------
# Web Framework
# ------------------------------------------------------------------------------

# FastAPI — современный веб-фреймворк для создания API.
# Используется для:
#   - Веб-админки (SQLAdmin)
#   - Health check эндпоинта
#   - Webhook для Telegram (если используется)
fastapi>=0.128.0,<1.0

# uvicorn — ASGI сервер для запуска FastAPI приложения.
# Производительный, асинхронный, поддерживает HTTP/2.
uvicorn>=0.40.0,<1.0


# APScheduler — планировщик фоновых задач по расписанию.
# Нужен для системы подписок (автопродление, напоминания, обработка неудачных продлений).
APScheduler>=3.10.4

# ------------------------------------------------------------------------------
# Configuration & Settings
# ------------------------------------------------------------------------------

# pydantic — валидация данных и настроек через Python type hints.
# Используется для валидации конфига, моделей, API-запросов.
pydantic>=2.12.0,<3.0

# pydantic-settings — расширение Pydantic для загрузки настроек из .env файлов.
# Автоматически читает переменные окружения и валидирует их.
pydantic-settings>=2.12.0,<3.0

# pyyaml — парсер YAML файлов.
# Используется для загрузки config.yaml с настройками моделей.
pyyaml>=6.0.3

# python-dotenv — загрузка переменных окружения из .env файла.
# Полезно для локальной разработки, в продакшене переменные задаются напрямую.
python-dotenv>=1.2.0

# ------------------------------------------------------------------------------
# Database
# ------------------------------------------------------------------------------

# SQLAlchemy 2.0 — современный асинхронный ORM для Python.
# [asyncio] — включает поддержку async/await.
# Используется для работы с базой данных (PostgreSQL в продакшене).
sqlalchemy[asyncio]>=2.0.45,<3.0

# asyncpg — асинхронный драйвер для PostgreSQL.
# Используется в продакшене (Amvera предоставляет PostgreSQL).
# Самый быстрый драйвер для PostgreSQL в Python.
asyncpg>=0.30.0

# aiosqlite — асинхронный драйвер для SQLite.
# Используется как на проде, так и в разработке.
# SQLite может быть fallback-решением или использоваться для локальных кэшей.
aiosqlite>=0.21.0

# alembic — инструмент для миграций базы данных.
# Миграции — это версионирование структуры БД (как git для схемы).
# При изменении моделей создаётся миграция, которая применяется к БД.
alembic>=1.15.0

# SQLAdmin — веб-админка для SQLAlchemy моделей.
# Автоматически генерирует интерфейс для просмотра и редактирования данных.
# Интегрируется с FastAPI/Starlette.
sqladmin>=0.20.0

# itsdangerous — безопасная сериализация данных.
# Используется SQLAdmin для подписи cookies и защиты сессий от подделки.
itsdangerous>=2.2.0

# tzdata — база данных часовых поясов IANA.
# Необходим для работы zoneinfo на Windows (на Linux/macOS данные есть в системе).
# Используется для отображения времени в логах и админке в нужной часовой зоне.
tzdata>=2024.1

# ------------------------------------------------------------------------------
# AI Providers
# ------------------------------------------------------------------------------

# OpenAI — официальный клиент для OpenAI API.
# ЕДИНСТВЕННАЯ библиотека для AI-провайдеров в проекте.
# Используется для:
#   - OpenRouter (openrouter.ai) — агрегатор моделей GPT, Claude, DALL-E и других
#   - RouterAI (routerai.ru) — российский OpenAI-совместимый сервис
# Оба провайдера используют OpenAI-формат API, поэтому достаточно одного клиента.
# Поддерживает: chat (GPT/Claude), image (DALL-E), tts (OpenAI TTS), stt (Whisper).
openai>=2.14.0,<3.0

# httpx — современный HTTP-клиент с поддержкой async/await.
# Используется для:
#   - Кастомных API-вызовов к провайдерам
#   - Загрузки файлов (изображения, аудио)
#   - Проксирования запросов (если нужен прокси для OpenRouter/RouterAI)
# Преимущества над aiohttp: проще API, лучше типизация, встроенная поддержка HTTP/2.
httpx>=0.28.0

# ------------------------------------------------------------------------------
# FSM Storage
# ------------------------------------------------------------------------------

# aiogram-fsm-sqlitestorage — SQLite хранилище для FSM-состояний aiogram.
# Используется для сохранения состояний диалогов (FSM) между перезапусками бота.
# Преимущества:
#   - Данные сохраняются в файл (не теряются при рестарте)
#   - Не требует внешних сервисов (Redis, PostgreSQL)
#   - На Amvera файл хранится в /data — переживает деплои
#   - Совместима с aiogram 3.x, тесты основаны на aiogram v3.13.1
aiogram-fsm-sqlitestorage>=1.0.0,<2.0
