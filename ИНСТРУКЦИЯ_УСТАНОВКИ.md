# Инструкция по установке и настройке проекта Unibot

## Шаг 1: Проверка Python 3.11

Откройте командную строку (cmd) или PowerShell и выполните:

```bash
python --version
```

Должно быть: `Python 3.11.x`

Если Python не установлен или версия не 3.11:
1. Скачайте Python 3.11 с https://www.python.org/downloads/
2. При установке **обязательно** отметьте "Add Python to PATH"
3. Перезапустите командную строку и проверьте снова

## Шаг 2: Автоматическая установка (рекомендуется)

### Вариант A: Через батник (Windows)

1. Откройте папку проекта: `C:\Users\Евгений\Documents\unibot-main\unibot-main`
2. Дважды кликните на файл `setup_project.bat`
3. Дождитесь завершения установки

### Вариант B: Через PowerShell

1. Откройте PowerShell в папке проекта
2. Выполните:
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope Process
.\setup_project.ps1
```

## Шаг 3: Ручная установка (если автоматическая не работает)

Откройте командную строку в папке проекта и выполните команды по порядку:

### 3.1. Создание виртуального окружения

```bash
python -m venv .venv
```

### 3.2. Активация виртуального окружения

**Windows (cmd):**
```bash
.venv\Scripts\activate.bat
```

**Windows (PowerShell):**
```powershell
.venv\Scripts\Activate.ps1
```

### 3.3. Обновление pip

```bash
python -m pip install --upgrade pip
```

### 3.4. Установка зависимостей

```bash
pip install -r requirements.txt
pip install -r requirements-dev.txt
```

### 3.5. Настройка .env файла

```bash
copy .env.example .env
```

Затем откройте файл `.env` в текстовом редакторе и укажите:

```env
BOT__TOKEN=ваш_токен_бота
LOGGING__LEVEL=DEBUG
```

**Как получить токен бота:**
1. Откройте Telegram и найдите @BotFather
2. Отправьте команду `/newbot`
3. Следуйте инструкциям
4. Скопируйте токен (формат: `123456789:ABCdefGHIjklMNOpqrsTUVwxyz`)

### 3.6. Применение миграций базы данных

```bash
alembic upgrade head
```

## Шаг 4: Запуск бота

### Вариант A: Через командную строку

Убедитесь, что виртуальное окружение активировано, затем:

```bash
uvicorn src.main:app --reload --host 0.0.0.0 --port 8000
```

### Вариант B: Через VSCode

1. Откройте проект в VSCode
2. Нажмите **F5** (или Run → Start Debugging)
3. Выберите конфигурацию "Unibot" или "Unibot (без hot reload)"

## Проверка работы

После запуска проверьте:

1. **Health check:** Откройте в браузере http://localhost:8000/health
   - Должно быть: `{"status": "ok"}`

2. **Админка:** http://localhost:8000/admin
   - Логин/пароль из `.env` (`ADMIN__USERNAME` / `ADMIN__PASSWORD`)
   - Если не указаны — админка недоступна (это нормально)

3. **Бот в Telegram:** Напишите `/start` боту

## Возможные проблемы

### Python не найден
- Убедитесь, что Python установлен и добавлен в PATH
- Перезапустите командную строку после установки Python

### Ошибка при установке зависимостей
- Проверьте подключение к интернету
- Попробуйте обновить pip: `python -m pip install --upgrade pip`
- Для некоторых библиотек может потребоваться компилятор C++ (Visual Studio Build Tools)

### Ошибка миграций
- Убедитесь, что виртуальное окружение активировано
- Проверьте, что все зависимости установлены
- Попробуйте удалить папку `data/` и запустить миграции заново

### Бот не отвечает
- Проверьте, что токен указан правильно в `.env`
- Убедитесь, что бот запущен (проверьте логи в консоли)
- Проверьте, что в `.env` не указан `APP__DOMAIN` (для локальной разработки)

## Дополнительная информация

- Полная документация: `README.md`
- Конфигурация моделей и тарифов: `config.yaml`
- Настройки окружения: `.env` (создаётся из `.env.example`)




